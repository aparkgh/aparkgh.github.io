<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrolling Text Fix</title>
    <style>
        .scrolling-text {
            width: 100%;
            overflow: hidden;
            background: #f0f0f0;
            border-top: 1px solid #ccc;
            margin-top: 12px;
            height: 20px;
            line-height: 20px;
            position: relative;
        }

        .scrolling-track {
            display: flex;
            white-space: nowrap;
            /* Width will be set dynamically via JavaScript */
            /* Animation will be set dynamically via JavaScript */
        }

        .scrolling-track span {
            padding-right: 2rem; /* space between repetitions */
            font-size: 12px;
            font-family: 'FreePixel', Tahoma, sans-serif;
            color: #333;
        }

        @keyframes scroll-left {
            0% {
                transform: translateX(0%);
            }
            100% {
                transform: translateX(-50%);
            }
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .scrolling-text {
                height: 18px;
                line-height: 18px;
            }
            
            .scrolling-track span {
                font-size: 11px;
                padding-right: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .scrolling-text {
                height: 16px;
                line-height: 16px;
            }
            
            .scrolling-track span {
                font-size: 10px;
                padding-right: 1rem;
            }
        }

        /* Reduce motion for accessibility */
        @media (prefers-reduced-motion: reduce) {
            .scrolling-track {
                animation-duration: 30s !important;
            }
        }
    </style>
</head>
<body>
    <div class="scrolling-text">
        <div class="scrolling-track" id="scrolling-track">
            <span id="scrolling-content">ANDREW PARK • </span>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const track = document.getElementById("scrolling-track");
            const content = document.getElementById("scrolling-content");

            function setupScrolling() {
                // Clear any existing content except the original
                const originalContent = content.textContent;
                track.innerHTML = `<span id="scrolling-content">${originalContent}</span>`;
                
                // Get fresh reference after clearing
                const newContent = document.getElementById("scrolling-content");
                
                // Create a temporary container to measure content without affecting layout
                const tempContainer = document.createElement('div');
                tempContainer.style.position = 'absolute';
                tempContainer.style.visibility = 'hidden';
                tempContainer.style.top = '-9999px';
                tempContainer.style.display = 'flex';
                tempContainer.style.whiteSpace = 'nowrap';
                
                const tempSpan = document.createElement('span');
                tempSpan.textContent = originalContent;
                tempSpan.style.fontSize = window.getComputedStyle(newContent).fontSize;
                tempSpan.style.fontFamily = window.getComputedStyle(newContent).fontFamily;
                tempSpan.style.paddingRight = window.getComputedStyle(newContent).paddingRight;
                
                tempContainer.appendChild(tempSpan);
                document.body.appendChild(tempContainer);
                
                const contentWidth = tempSpan.offsetWidth;
                document.body.removeChild(tempContainer);
                
                const containerWidth = track.parentElement.offsetWidth;

                if (contentWidth === 0) {
                    console.warn("Content width is 0 — retrying in 100ms");
                    setTimeout(setupScrolling, 100);
                    return;
                }

                // Calculate how many repetitions we need
                const repeatCount = Math.ceil((containerWidth * 3) / contentWidth);

                // Clone the content multiple times
                for (let i = 1; i < repeatCount; i++) {
                    const clone = newContent.cloneNode(true);
                    clone.removeAttribute('id'); // Remove ID from clones
                    track.appendChild(clone);
                }

                // Now measure the actual track width after adding all content
                // Temporarily allow it to expand to measure, but constrain it immediately
                track.style.width = 'auto';
                track.style.display = 'inline-flex'; // This prevents full expansion
                const totalContentWidth = track.offsetWidth;
                track.style.display = 'flex'; // Reset to flex
                track.style.width = totalContentWidth + 'px';

                // Calculate animation duration based on content width and desired speed
                const speed = window.innerWidth < 768 ? 150 : 200; // Slower on mobile
                const duration = (totalContentWidth / 2) / speed; // Divide by 2 because we translate by -50%

                // Apply the animation
                track.style.animation = `scroll-left ${duration}s linear infinite`;
            }

            // Initial setup with a small delay to ensure layout is complete
            setTimeout(setupScrolling, 100);

            // Re-setup on window resize for responsiveness
            let resizeTimer;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(setupScrolling, 250);
            });
        });
    </script>
</body>
</html>